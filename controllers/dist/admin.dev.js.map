{"version":3,"sources":["admin.js"],"names":["Product","require","exports","getAddProduct","req","res","next","render","pageTitle","path","editing","postAddProduct","title","body","imageUrl","price","description","product","user","_id","save","then","result","console","log","redirect","err","getEditProduct","editMode","query","edit","prodId","params","productId","findByPk","products","postEditProduct","updatedTitle","updatedPrice","updatedImageUrl","updatedDesc","getProducts","fetchAll","prods","postDeleteProduct","deleteById"],"mappings":";;AAAA;AACA;AACA,IAAMA,OAAO,GAAGC,OAAO,CAAC,mBAAD,CAAvB;;AAEAC,OAAO,CAACC,aAAR,GAAwB,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC1CD,EAAAA,GAAG,CAACE,MAAJ,CAAW,oBAAX,EAAiC;AAC/BC,IAAAA,SAAS,EAAE,aADoB;AAE/BC,IAAAA,IAAI,EAAE,oBAFyB;AAG/BC,IAAAA,OAAO,EAAE;AAHsB,GAAjC;AAKD,CAND;;AAQAR,OAAO,CAACS,cAAR,GAAyB,UAACP,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC3C,MAAMM,KAAK,GAAGR,GAAG,CAACS,IAAJ,CAASD,KAAvB;AACA,MAAME,QAAQ,GAAGV,GAAG,CAACS,IAAJ,CAASC,QAA1B;AACA,MAAMC,KAAK,GAAGX,GAAG,CAACS,IAAJ,CAASE,KAAvB;AACA,MAAMC,WAAW,GAAGZ,GAAG,CAACS,IAAJ,CAASG,WAA7B;AACA,MAAMC,OAAO,GAAG,IAAIjB,OAAJ,CAAYY,KAAZ,EACdG,KADc,EAEdC,WAFc,EAGdF,QAHc,EAId,IAJc,EAKdV,GAAG,CAACc,IAAJ,CAASC,GALK,CAAhB;AAOAF,EAAAA,OAAO,CACJG,IADH,GAEGC,IAFH,CAEQ,UAAAC,MAAM,EAAI;AACd;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;AACAnB,IAAAA,GAAG,CAACoB,QAAJ,CAAa,iBAAb;AACD,GANH,WAOS,UAAAC,GAAG,EAAI;AACZH,IAAAA,OAAO,CAACC,GAAR,CAAYE,GAAZ;AACD,GATH;AAUD,CAtBD;;AAwBAxB,OAAO,CAACyB,cAAR,GAAyB,UAACvB,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC3C,MAAMsB,QAAQ,GAAGxB,GAAG,CAACyB,KAAJ,CAAUC,IAA3B;;AACA,MAAI,CAACF,QAAL,EAAe;AACb,WAAOvB,GAAG,CAACoB,QAAJ,CAAa,GAAb,CAAP;AACD;;AACD,MAAMM,MAAM,GAAG3B,GAAG,CAAC4B,MAAJ,CAAWC,SAA1B;AACAjC,EAAAA,OAAO,CAACkC,QAAR,CAAiBH,MAAjB,EACGV,IADH,CACQ,UAAAc,QAAQ,EAAI;AAChB,QAAMlB,OAAO,GAAGkB,QAAQ,CAAC,CAAD,CAAxB;;AACA,QAAI,CAAClB,OAAL,EAAc;AACZ,aAAOZ,GAAG,CAACoB,QAAJ,CAAa,GAAb,CAAP;AACD;;AACDpB,IAAAA,GAAG,CAACE,MAAJ,CAAW,oBAAX,EAAiC;AAC/BC,MAAAA,SAAS,EAAE,cADoB;AAE/BC,MAAAA,IAAI,EAAE,qBAFyB;AAG/BC,MAAAA,OAAO,EAAEkB,QAHsB;AAI/BX,MAAAA,OAAO,EAAEA;AAJsB,KAAjC;AAMD,GAZH,WAaS,UAAAS,GAAG;AAAA,WAAIH,OAAO,CAACC,GAAR,CAAYE,GAAZ,CAAJ;AAAA,GAbZ;AAcD,CApBD;;AAsBAxB,OAAO,CAACkC,eAAR,GAA0B,UAAChC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC5C,MAAMyB,MAAM,GAAG3B,GAAG,CAACS,IAAJ,CAASoB,SAAxB;AACA,MAAMI,YAAY,GAAGjC,GAAG,CAACS,IAAJ,CAASD,KAA9B;AACA,MAAM0B,YAAY,GAAGlC,GAAG,CAACS,IAAJ,CAASE,KAA9B;AACA,MAAMwB,eAAe,GAAGnC,GAAG,CAACS,IAAJ,CAASC,QAAjC;AACA,MAAM0B,WAAW,GAAGpC,GAAG,CAACS,IAAJ,CAASG,WAA7B;AAEA,MAAMC,OAAO,GAAG,IAAIjB,OAAJ,CACdqC,YADc,EAEdC,YAFc,EAGdE,WAHc,EAIdD,eAJc,EAKdR,MALc,CAAhB;AAOAd,EAAAA,OAAO,CACJG,IADH,GAEGC,IAFH,CAEQ,UAAAC,MAAM,EAAI;AACdC,IAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ;AACAnB,IAAAA,GAAG,CAACoB,QAAJ,CAAa,iBAAb;AACD,GALH,WAMS,UAAAC,GAAG;AAAA,WAAIH,OAAO,CAACC,GAAR,CAAYE,GAAZ,CAAJ;AAAA,GANZ;AAOD,CArBD;;AAuBAxB,OAAO,CAACuC,WAAR,GAAsB,UAACrC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACxCN,EAAAA,OAAO,CAAC0C,QAAR,GACGrB,IADH,CACQ,UAAAc,QAAQ,EAAI;AAChB9B,IAAAA,GAAG,CAACE,MAAJ,CAAW,gBAAX,EAA6B;AAC3BoC,MAAAA,KAAK,EAAER,QADoB;AAE3B3B,MAAAA,SAAS,EAAE,gBAFgB;AAG3BC,MAAAA,IAAI,EAAE;AAHqB,KAA7B;AAKD,GAPH,WAQS,UAAAiB,GAAG,EAAI;AACZH,IAAAA,OAAO,CAACC,GAAR,CAAYE,GAAZ;AACD,GAVH;AAWD,CAZD;;AAcAxB,OAAO,CAAC0C,iBAAR,GAA4B,UAACxC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC9C,MAAMyB,MAAM,GAAG3B,GAAG,CAACS,IAAJ,CAASoB,SAAxB;AACAjC,EAAAA,OAAO,CAAC6C,UAAR,CAAmBd,MAAnB,EACGV,IADH,CACQ,YAAM;AACVE,IAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ;AACAnB,IAAAA,GAAG,CAACoB,QAAJ,CAAa,iBAAb;AACD,GAJH,WAKS,UAAAC,GAAG;AAAA,WAAIH,OAAO,CAACC,GAAR,CAAYE,GAAZ,CAAJ;AAAA,GALZ;AAMD,CARD","sourcesContent":["// const { redirect } = require('express/lib/response')\r\n// const Product = require('../models/product')\r\nconst Product = require('../models/product')\r\n\r\nexports.getAddProduct = (req, res, next) => {\r\n  res.render('admin/edit-product', {\r\n    pageTitle: 'Add Product',\r\n    path: '/admin/add-product',\r\n    editing: false\r\n  })\r\n}\r\n\r\nexports.postAddProduct = (req, res, next) => {\r\n  const title = req.body.title\r\n  const imageUrl = req.body.imageUrl\r\n  const price = req.body.price\r\n  const description = req.body.description\r\n  const product = new Product(title,\r\n    price,\r\n    description,\r\n    imageUrl,\r\n    null,\r\n    req.user._id\r\n  )\r\n  product\r\n    .save()\r\n    .then(result => {\r\n      // console.log(result)\r\n      console.log('Created Product')\r\n      res.redirect('/admin/products')\r\n    })\r\n    .catch(err => {\r\n      console.log(err)\r\n    })\r\n}\r\n\r\nexports.getEditProduct = (req, res, next) => {\r\n  const editMode = req.query.edit\r\n  if (!editMode) {\r\n    return res.redirect('/')\r\n  }\r\n  const prodId = req.params.productId\r\n  Product.findByPk(prodId)\r\n    .then(products => {\r\n      const product = products[0]\r\n      if (!product) {\r\n        return res.redirect('/')\r\n      }\r\n      res.render('admin/edit-product', {\r\n        pageTitle: 'Edit Product',\r\n        path: '/admin/edit-product',\r\n        editing: editMode,\r\n        product: product\r\n      })\r\n    })\r\n    .catch(err => console.log(err))\r\n}\r\n\r\nexports.postEditProduct = (req, res, next) => {\r\n  const prodId = req.body.productId\r\n  const updatedTitle = req.body.title\r\n  const updatedPrice = req.body.price\r\n  const updatedImageUrl = req.body.imageUrl\r\n  const updatedDesc = req.body.description\r\n\r\n  const product = new Product(\r\n    updatedTitle,\r\n    updatedPrice,\r\n    updatedDesc,\r\n    updatedImageUrl,\r\n    prodId\r\n  )\r\n  product\r\n    .save()\r\n    .then(result => {\r\n      console.log('Updated Product!')\r\n      res.redirect('/admin/products')\r\n    })\r\n    .catch(err => console.log(err))\r\n}\r\n\r\nexports.getProducts = (req, res, next) => {\r\n  Product.fetchAll()\r\n    .then(products => {\r\n      res.render('admin/products', {\r\n        prods: products,\r\n        pageTitle: 'Admin Products',\r\n        path: '/admin/products'\r\n      })\r\n    })\r\n    .catch(err => {\r\n      console.log(err)\r\n    })\r\n}\r\n\r\nexports.postDeleteProduct = (req, res, next) => {\r\n  const prodId = req.body.productId\r\n  Product.deleteById(prodId)\r\n    .then(() => {\r\n      console.log('Destroyed Product!')\r\n      res.redirect('/admin/products')\r\n    })\r\n    .catch(err => console.log(err))\r\n}\r\n"],"file":"admin.dev.js"}