{"version":3,"sources":["admin.js"],"names":["require","redirect","Product","exports","getAddProduct","req","res","next","render","pageTitle","path","editing","postAddProduct","title","body","imageUrl","price","description","user","createProduct","then","result","console","log","err","getEditProduct","editMode","query","edit","prodId","params","productId","getProducts","where","id","products","product","postEditProduct","updatedTitle","updatedPrice","updatedImageUrl","updatedDesc","findById","save","prods","postDeleteProduct","destroy"],"mappings":";;eAAqBA,OAAO,CAAC,sBAAD,C;IAApBC,Q,YAAAA,Q;;AACR,IAAMC,OAAO,GAAGF,OAAO,CAAC,mBAAD,CAAvB;;AAEAG,OAAO,CAACC,aAAR,GAAwB,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC1CD,EAAAA,GAAG,CAACE,MAAJ,CAAW,oBAAX,EAAiC;AAC/BC,IAAAA,SAAS,EAAE,aADoB;AAE/BC,IAAAA,IAAI,EAAE,oBAFyB;AAG/BC,IAAAA,OAAO,EAAE;AAHsB,GAAjC;AAKD,CAND;;AAQAR,OAAO,CAACS,cAAR,GAAyB,UAACP,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC3C,MAAMM,KAAK,GAAGR,GAAG,CAACS,IAAJ,CAASD,KAAvB;AACA,MAAME,QAAQ,GAAGV,GAAG,CAACS,IAAJ,CAASC,QAA1B;AACA,MAAMC,KAAK,GAAGX,GAAG,CAACS,IAAJ,CAASE,KAAvB;AACA,MAAMC,WAAW,GAAGZ,GAAG,CAACS,IAAJ,CAASG,WAA7B;AACAZ,EAAAA,GAAG,CAACa,IAAJ,CAASC,aAAT,CAAuB;AACrBN,IAAAA,KAAK,EAAEA,KADc;AAErBG,IAAAA,KAAK,EAAEA,KAFc;AAGrBD,IAAAA,QAAQ,EAAEA,QAHW;AAIrBE,IAAAA,WAAW,EAAEA;AAJQ,GAAvB,EAMGG,IANH,CAMQ,UAAAC,MAAM,EAAI;AACdC,IAAAA,OAAO,CAACC,GAAR,CAAYF,MAAZ;AACAf,IAAAA,GAAG,CAACL,QAAJ,CAAa,iBAAb;AACD,GATH,WAUS,UAAAuB,GAAG,EAAI;AACZF,IAAAA,OAAO,CAACC,GAAR,CAAYC,GAAZ;AACD,GAZH;AAaD,CAlBD;;AAoBArB,OAAO,CAACsB,cAAR,GAAyB,UAACpB,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC3C,MAAMmB,QAAQ,GAAGrB,GAAG,CAACsB,KAAJ,CAAUC,IAA3B;;AACA,MAAI,CAACF,QAAL,EAAe;AACb,WAAOpB,GAAG,CAACL,QAAJ,CAAa,GAAb,CAAP;AACD;;AACD,MAAM4B,MAAM,GAAGxB,GAAG,CAACyB,MAAJ,CAAWC,SAA1B;AACA1B,EAAAA,GAAG,CAACa,IAAJ,CACGc,WADH,CACe;AAAEC,IAAAA,KAAK,EAAE;AAAEC,MAAAA,EAAE,EAAEL;AAAN;AAAT,GADf,EAEE;AAFF,GAGGT,IAHH,CAGQ,UAAAe,QAAQ,EAAI;AAChB,QAAMC,OAAO,GAAGD,QAAQ,CAAC,CAAD,CAAxB;;AACA,QAAI,CAACC,OAAL,EAAc;AACZ,aAAO9B,GAAG,CAACL,QAAJ,CAAa,GAAb,CAAP;AACD;;AACDK,IAAAA,GAAG,CAACE,MAAJ,CAAW,oBAAX,EAAiC;AAC/BC,MAAAA,SAAS,EAAE,cADoB;AAE/BC,MAAAA,IAAI,EAAE,qBAFyB;AAG/BC,MAAAA,OAAO,EAAEe,QAHsB;AAI/BU,MAAAA,OAAO,EAAEA;AAJsB,KAAjC;AAMD,GAdH,WAeS,UAAAZ,GAAG;AAAA,WAAIF,OAAO,CAACC,GAAR,CAAYC,GAAZ,CAAJ;AAAA,GAfZ;AAgBD,CAtBD;;AAwBArB,OAAO,CAACkC,eAAR,GAA0B,UAAChC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC5C,MAAMsB,MAAM,GAAGxB,GAAG,CAACS,IAAJ,CAASiB,SAAxB;AACA,MAAMO,YAAY,GAAGjC,GAAG,CAACS,IAAJ,CAASD,KAA9B;AACA,MAAM0B,YAAY,GAAGlC,GAAG,CAACS,IAAJ,CAASE,KAA9B;AACA,MAAMwB,eAAe,GAAGnC,GAAG,CAACS,IAAJ,CAASC,QAAjC;AACA,MAAM0B,WAAW,GAAGpC,GAAG,CAACS,IAAJ,CAASG,WAA7B;AACAf,EAAAA,OAAO,CAACwC,QAAR,CAAiBb,MAAjB,EACGT,IADH,CACQ,UAAAgB,OAAO,EAAI;AACfA,IAAAA,OAAO,CAACvB,KAAR,GAAgByB,YAAhB;AACAF,IAAAA,OAAO,CAACpB,KAAR,GAAgBuB,YAAhB;AACAH,IAAAA,OAAO,CAACnB,WAAR,GAAsBwB,WAAtB;AACAL,IAAAA,OAAO,CAACrB,QAAR,GAAmByB,eAAnB;AACA,WAAOJ,OAAO,CAACO,IAAR,EAAP;AACD,GAPH,EAQGvB,IARH,CAQQ,UAAAC,MAAM,EAAI;AACdC,IAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ;AACAjB,IAAAA,GAAG,CAACL,QAAJ,CAAa,iBAAb;AACD,GAXH,WAYS,UAAAuB,GAAG;AAAA,WAAIF,OAAO,CAACC,GAAR,CAAYC,GAAZ,CAAJ;AAAA,GAZZ;AAaD,CAnBD;;AAqBArB,OAAO,CAAC6B,WAAR,GAAsB,UAAC3B,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACxCF,EAAAA,GAAG,CAACa,IAAJ,CACGc,WADH,GAEGZ,IAFH,CAEQ,UAAAe,QAAQ,EAAI;AAChB7B,IAAAA,GAAG,CAACE,MAAJ,CAAW,gBAAX,EAA6B;AAC3BoC,MAAAA,KAAK,EAAET,QADoB;AAE3B1B,MAAAA,SAAS,EAAE,gBAFgB;AAG3BC,MAAAA,IAAI,EAAE;AAHqB,KAA7B;AAKD,GARH,WASS,UAAAc,GAAG,EAAI;AACZF,IAAAA,OAAO,CAACC,GAAR,CAAYC,GAAZ;AACD,GAXH;AAYD,CAbD;;AAeArB,OAAO,CAAC0C,iBAAR,GAA4B,UAACxC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC9C,MAAMsB,MAAM,GAAGxB,GAAG,CAACS,IAAJ,CAASiB,SAAxB;AACA7B,EAAAA,OAAO,CAACwC,QAAR,CAAiBb,MAAjB,EACGT,IADH,CACQ,UAAAgB,OAAO,EAAI;AACf,WAAOA,OAAO,CAACU,OAAR,EAAP;AACD,GAHH,EAIG1B,IAJH,CAIQ,UAAAC,MAAM,EAAI;AACdC,IAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ;AACAjB,IAAAA,GAAG,CAACL,QAAJ,CAAa,iBAAb;AACD,GAPH,WAQS,UAAAuB,GAAG;AAAA,WAAIF,OAAO,CAACC,GAAR,CAAYC,GAAZ,CAAJ;AAAA,GARZ;AASD,CAXD","sourcesContent":["const { redirect } = require('express/lib/response')\r\nconst Product = require('../models/product')\r\n\r\nexports.getAddProduct = (req, res, next) => {\r\n  res.render('admin/edit-product', {\r\n    pageTitle: 'Add Product',\r\n    path: '/admin/add-product',\r\n    editing: false\r\n  })\r\n}\r\n\r\nexports.postAddProduct = (req, res, next) => {\r\n  const title = req.body.title\r\n  const imageUrl = req.body.imageUrl\r\n  const price = req.body.price\r\n  const description = req.body.description\r\n  req.user.createProduct({\r\n    title: title,\r\n    price: price,\r\n    imageUrl: imageUrl,\r\n    description: description\r\n  })\r\n    .then(result => {\r\n      console.log(result)\r\n      res.redirect('/admin/products')\r\n    })\r\n    .catch(err => {\r\n      console.log(err)\r\n    })\r\n}\r\n\r\nexports.getEditProduct = (req, res, next) => {\r\n  const editMode = req.query.edit\r\n  if (!editMode) {\r\n    return res.redirect('/')\r\n  }\r\n  const prodId = req.params.productId\r\n  req.user\r\n    .getProducts({ where: { id: prodId } })\r\n    // Product.findById(prodId)\r\n    .then(products => {\r\n      const product = products[0]\r\n      if (!product) {\r\n        return res.redirect('/')\r\n      }\r\n      res.render('admin/edit-product', {\r\n        pageTitle: 'Edit Product',\r\n        path: '/admin/edit-product',\r\n        editing: editMode,\r\n        product: product\r\n      })\r\n    })\r\n    .catch(err => console.log(err))\r\n}\r\n\r\nexports.postEditProduct = (req, res, next) => {\r\n  const prodId = req.body.productId\r\n  const updatedTitle = req.body.title\r\n  const updatedPrice = req.body.price\r\n  const updatedImageUrl = req.body.imageUrl\r\n  const updatedDesc = req.body.description\r\n  Product.findById(prodId)\r\n    .then(product => {\r\n      product.title = updatedTitle\r\n      product.price = updatedPrice\r\n      product.description = updatedDesc\r\n      product.imageUrl = updatedImageUrl\r\n      return product.save()\r\n    })\r\n    .then(result => {\r\n      console.log('Updated Product!')\r\n      res.redirect('/admin/products')\r\n    })\r\n    .catch(err => console.log(err))\r\n}\r\n\r\nexports.getProducts = (req, res, next) => {\r\n  req.user\r\n    .getProducts()\r\n    .then(products => {\r\n      res.render('admin/products', {\r\n        prods: products,\r\n        pageTitle: 'Admin Products',\r\n        path: '/admin/products'\r\n      })\r\n    })\r\n    .catch(err => {\r\n      console.log(err)\r\n    })\r\n}\r\n\r\nexports.postDeleteProduct = (req, res, next) => {\r\n  const prodId = req.body.productId\r\n  Product.findById(prodId)\r\n    .then(product => {\r\n      return product.destroy()\r\n    })\r\n    .then(result => {\r\n      console.log('Destroyed Product!')\r\n      res.redirect('/admin/products')\r\n    })\r\n    .catch(err => console.log(err))\r\n}\r\n"],"file":"admin.dev.js"}