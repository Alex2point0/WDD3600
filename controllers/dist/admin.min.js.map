{"version":3,"sources":["admin.js"],"names":["Product","require","exports","req","res","next","render","getAddProduct","pageTitle","postAddProduct","title","body","imageUrl","price","description","product","console","log","then","result","getEditProduct","err","editMode","prodId","productId","redirect","findByPk","products","path","editing","postEditProduct","updatedPrice","updatedImageUrl","updatedDesc","updatedTitle","prods","getProducts","postDeleteProduct","deleteById"],"mappings":"aAAA,IAAAA,QAAAC,QAAA,qBAEAC,QAAMF,cAAkB,SAAAG,EAAAC,EAAAC,GAGtBD,EAAIE,OAAO,qBAAsB,CADnCJ,UAAQK,cACNH,KAAIE,qBACFE,SAAS,KAIZN,QANDO,eAAA,SAAAN,EAAAC,EAAAC,GASE,IAAMK,EAAQP,EAAIQ,KAAKD,MADjBD,EAAAA,EAARE,KAAyBC,SACjBF,EAAQP,EAAIQ,KAAKD,MACjBE,EAAeD,EAAKC,KAAAA,YACRD,IAAJX,QAAdU,EACAG,EACAC,EAOAC,EAGI,KACAC,EAAAA,KAAQC,KAIRD,OARJE,KAAA,SAAAC,GAIIH,QAAQC,IAAI,mBAQlBf,EAAQkB,SAAAA,qBANH,MACM,SAAAC,GAOLL,QAACM,IAAUD,MAGfnB,QAAMqB,eAAS,SAAWC,EAAAA,EAA1BnB,GACAL,IAAAA,EAAiBuB,EAAAA,MACdL,KACC,IAAAI,EALF,OAAOlB,EAAIqB,SAAS,KAOhB,IAAAF,EAAWE,EAAAA,OAASD,UACrBxB,QAAA0B,SAAAH,GAJFL,KAAK,SAAAS,GAKJvB,IAAIE,EAAOqB,EAAA,GACTnB,IAAAA,EACAoB,OAAMxB,EAAAqB,SAAA,KAENV,EAAAA,OAASA,qBAAAA,CAJXP,UAAA,eANJoB,KAaS,sBAAGC,QAAIb,EAbhBD,QAAAA,MAKK,MAWCe,SAAAA,GAAAA,OAAAA,QAAkBb,IAAAI,MAGxBnB,QAAM6B,gBAAmBpB,SAAAA,EAAKE,EAA9BR,GACA,IAAM2B,EAAAA,EAAerB,KAAGR,UAClB8B,EAAiB9B,EAACQ,KAAKG,MAEvBC,EAAcf,EAAJW,KACduB,MAMFnB,EAEQZ,EAAAQ,KAAAQ,SACJH,EAAYb,EAAAQ,KAAAG,YAGP,IAAAd,QAAGkC,EANZH,EAdFE,EAWID,EAYJ9B,GAIQiC,OACA3B,KAAAA,SAAAA,GACAoB,QAAMX,IAAA,oBAHRb,EAAAqB,SAAA,qBAAArB,MAOO,SAAAiB,GAACJ,OAAII,QAAZJ,IAAAI,MAVNnB,QAAQkC,YAAc,SAACjC,EAAKC,EAAKC,GAcjCH,QAAQmC,WACNnB,KAAMK,SAAAA,GACNvB,EAAQsC,OAAAA,iBACA,CACJtB,MAAAW,EACIF,UAAS,iBAHjBG,KAKS,sBAPX1B,MAAA,SAAAmB,GAJML,QAAQC,IAAII,MAIlBnB,QAAQmC,kBAAoB,SAAClC,EAAKC,EAAKC,GACrC,IAAMkB,EAASpB,EAAIQ,KAAKa,UACxBxB,QAAQsC,WAAWf,GAChBL,KAAK,WACJF,QAAQC,IAAI,sBACZb,EAAIqB,SAAS,qBAHjB,MAKS,SAAAJ,GAAG,OAAIL,QAAQC,IAAII","file":"admin.min.js","sourcesContent":["// const { redirect } = require('express/lib/response')\r\n// const Product = require('../models/product')\r\nconst Product = require('../models/product')\r\n\r\nexports.getAddProduct = (req, res, next) => {\r\n  res.render('admin/edit-product', {\r\n    pageTitle: 'Add Product',\r\n    path: '/admin/add-product',\r\n    editing: false\r\n  })\r\n}\r\n\r\nexports.postAddProduct = (req, res, next) => {\r\n  const title = req.body.title\r\n  const imageUrl = req.body.imageUrl\r\n  const price = req.body.price\r\n  const description = req.body.description\r\n  const product = new Product(title,\r\n    price,\r\n    description,\r\n    imageUrl,\r\n    null,\r\n    req.user._id\r\n  )\r\n  product\r\n    .save()\r\n    .then(result => {\r\n      // console.log(result)\r\n      console.log('Created Product')\r\n      res.redirect('/admin/products')\r\n    })\r\n    .catch(err => {\r\n      console.log(err)\r\n    })\r\n}\r\n\r\nexports.getEditProduct = (req, res, next) => {\r\n  const editMode = req.query.edit\r\n  if (!editMode) {\r\n    return res.redirect('/')\r\n  }\r\n  const prodId = req.params.productId\r\n  Product.findByPk(prodId)\r\n    .then(products => {\r\n      const product = products[0]\r\n      if (!product) {\r\n        return res.redirect('/')\r\n      }\r\n      res.render('admin/edit-product', {\r\n        pageTitle: 'Edit Product',\r\n        path: '/admin/edit-product',\r\n        editing: editMode,\r\n        product: product\r\n      })\r\n    })\r\n    .catch(err => console.log(err))\r\n}\r\n\r\nexports.postEditProduct = (req, res, next) => {\r\n  const prodId = req.body.productId\r\n  const updatedTitle = req.body.title\r\n  const updatedPrice = req.body.price\r\n  const updatedImageUrl = req.body.imageUrl\r\n  const updatedDesc = req.body.description\r\n\r\n  const product = new Product(\r\n    updatedTitle,\r\n    updatedPrice,\r\n    updatedDesc,\r\n    updatedImageUrl,\r\n    prodId\r\n  )\r\n  product\r\n    .save()\r\n    .then(result => {\r\n      console.log('Updated Product!')\r\n      res.redirect('/admin/products')\r\n    })\r\n    .catch(err => console.log(err))\r\n}\r\n\r\nexports.getProducts = (req, res, next) => {\r\n  Product.fetchAll()\r\n    .then(products => {\r\n      res.render('admin/products', {\r\n        prods: products,\r\n        pageTitle: 'Admin Products',\r\n        path: '/admin/products'\r\n      })\r\n    })\r\n    .catch(err => {\r\n      console.log(err)\r\n    })\r\n}\r\n\r\nexports.postDeleteProduct = (req, res, next) => {\r\n  const prodId = req.body.productId\r\n  Product.deleteById(prodId)\r\n    .then(() => {\r\n      console.log('Destroyed Product!')\r\n      res.redirect('/admin/products')\r\n    })\r\n    .catch(err => console.log(err))\r\n}\r\n"]}