{"version":3,"sources":["shop.js"],"names":["Product","require","exports","getProducts","req","res","next","fetchAll","then","products","render","prods","pageTitle","path","err","console","log","getProduct","prodId","params","productId","findByPk","product","title","getIndex","getCart","user","postCart","body","findbyid","addToCart","result","redirect","postCartDeleteProduct","deleteItemFromCart","postOrder","fetchedCart","addOrder","getOrders","orders"],"mappings":"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","sourcesContent":["// constant holding required product location\r\nconst Product = require('../models/product')\r\n\r\n// export function to get all products\r\nexports.getProducts = (req, res, next) => {\r\n  Product.fetchAll()\r\n    .then(products => {\r\n      res.render('shop/product-list', {\r\n        prods: products,\r\n        pageTitle: 'All Products',\r\n        path: '/products'\r\n      })\r\n    })\r\n    .catch(err => {\r\n      console.log(err)\r\n    })\r\n}\r\n\r\n// export function to get singular product\r\nexports.getProduct = (req, res, next) => {\r\n  const prodId = req.params.productId\r\n  Product.findByPk(prodId)\r\n    .then(product => {\r\n      res.render('shop/product-detail', {\r\n        product: product,\r\n        pageTitle: product.title,\r\n        path: '/products'\r\n      })\r\n    })\r\n    .catch(err => console.log(err))\r\n}\r\n\r\n// export function to get content for shop page\r\nexports.getIndex = (req, res, next) => {\r\n  Product.fetchAll()\r\n    .then(products => {\r\n      res.render('shop/index', {\r\n        prods: products,\r\n        pageTitle: 'Shop',\r\n        path: '/'\r\n      })\r\n    })\r\n    .catch(err => {\r\n      console.log(err)\r\n    })\r\n}\r\n\r\n// export function to get content for cart page\r\nexports.getCart = (req, res, next) => {\r\n  req.user\r\n    .getCart()\r\n    .then(products => {\r\n      res.render('shop/cart', {\r\n        path: '/cart',\r\n        pageTitle: 'Your Cart',\r\n        products: products\r\n      })\r\n    })\r\n    .catch(err => console.log(err))\r\n}\r\n\r\n// export function to get content for cart page\r\nexports.postCart = (req, res, next) => {\r\n  const prodId = req.body.productId\r\n  Product.findbyid(prodId).then(product => {\r\n    return req.user.addToCart(product)\r\n  })\r\n    .then(result => {\r\n      console.log(result)\r\n      res.redirect('/cart')\r\n    })\r\n  /*\r\n  let fetchedCart\r\n  let newQuantity = 1\r\n  req.user\r\n    .getCart()\r\n      fetchedCart = cart\r\n      return cart.getProducts({ where: { id: prodId } })\r\n    })\r\n    .then(products => {\r\n      let product\r\n      if (products.length > 0) {\r\n        product = products[0]\r\n      }\r\n      if (product) {\r\n        const oldQuantity = product.cartItem.quantity\r\n        newQuantity = oldQuantity + 1\r\n        return product\r\n      }\r\n      return Product.findById(prodId)\r\n    })\r\n    .then(product => {\r\n      return fetchedCart.addProduct(product, {\r\n        through: { quantity: newQuantity }\r\n      })\r\n    })\r\n    .then(() => {\r\n      res.redirect('/cart')\r\n    })\r\n    .catch(err => console.log(err))\r\n    */\r\n}\r\n\r\nexports.postCartDeleteProduct = (req, res, next) => {\r\n  const prodId = req.body.productId\r\n  req.user\r\n    .deleteItemFromCart(prodId)\r\n    .then(result => {\r\n      res.redirect('/cart')\r\n    })\r\n    .catch(err => console.log(err))\r\n}\r\n// something\r\nexports.postOrder = (req, res, next) => {\r\n  let fetchedCart\r\n  req.user\r\n    .addOrder()\r\n    .then(result => {\r\n      res.redirect('/orders')\r\n    })\r\n    .catch(err => console.log(err))\r\n}\r\n\r\n// export function to get content for orders page\r\nexports.getOrders = (req, res, next) => {\r\n  req.user\r\n    .getOrders()\r\n    .then(orders => {\r\n      res.render('shop/orders', {\r\n        path: '/orders',\r\n        pageTitle: 'Your Orders',\r\n        orders: orders\r\n      })\r\n    })\r\n    .catch(err => console.log(err))\r\n}\r\n"],"file":"shop.dev.js"}